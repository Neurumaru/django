# Generated by Django 4.1.2 on 2022-11-05 05:41

from django.conf import settings
from django.db import migrations, models
import django.db.models.deletion


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name='CPUSpec',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cpu_arch', models.TextField()),
                ('cpu_bits', models.IntegerField()),
                ('cpu_count', models.IntegerField()),
                ('cpu_arch_string_raw', models.TextField()),
                ('cpu_vendor_id_raw', models.TextField()),
                ('cpu_brand_raw', models.TextField()),
                ('cpu_hz_actural_friendly', models.BigIntegerField()),
            ],
        ),
        migrations.CreateModel(
            name='GPUSpec',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('gpu_index', models.IntegerField()),
                ('gpu_name', models.TextField()),
                ('gpu_brand', models.TextField()),
                ('gpu_nvml_version', models.TextField()),
                ('gpu_driver_version', models.TextField()),
                ('gpu_vbios_version', models.TextField()),
                ('gpu_multi_gpu_board', models.BooleanField()),
                ('gpu_display_mode', models.BooleanField()),
                ('gpu_display_active', models.BooleanField()),
                ('gpu_persistence_mode', models.BooleanField()),
                ('gpu_compute_mode', models.TextField()),
                ('gpu_power_management_mode', models.BooleanField()),
                ('gpu_power_management_limit', models.IntegerField()),
                ('gpu_enforced_power_limit', models.IntegerField()),
                ('gpu_temperature_shutdown', models.IntegerField()),
                ('gpu_temperature_slowdown', models.IntegerField()),
            ],
        ),
        migrations.CreateModel(
            name='MemorySpec',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('memory_total', models.BigIntegerField()),
            ],
        ),
        migrations.CreateModel(
            name='ReservedPort',
            fields=[
                ('reserved_port', models.IntegerField(primary_key=True, serialize=False)),
            ],
        ),
        migrations.CreateModel(
            name='MemoryStat',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('memory_available', models.BigIntegerField()),
                ('memory_used', models.BigIntegerField()),
                ('memory_free', models.BigIntegerField()),
                ('swap_total', models.BigIntegerField()),
                ('swap_used', models.BigIntegerField()),
                ('swap_free', models.BigIntegerField()),
                ('memory_update_time', models.DateTimeField(auto_now=True)),
                ('used_port', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='memory_stat', to='reverse_ssh_api.memoryspec')),
            ],
        ),
        migrations.CreateModel(
            name='GPUStat',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('gpu_power_usage', models.IntegerField()),
                ('gpu_temperature', models.IntegerField()),
                ('gpu_fan_speed', models.IntegerField()),
                ('gpu_clock_info_graphics', models.BigIntegerField()),
                ('gpu_clock_info_sm', models.BigIntegerField()),
                ('gpu_clock_info_mem', models.BigIntegerField()),
                ('gpu_clock_info_video', models.BigIntegerField()),
                ('gpu_memory_info_total', models.BigIntegerField()),
                ('gpu_memory_info_free', models.BigIntegerField()),
                ('gpu_memory_info_used', models.BigIntegerField()),
                ('gpu_bar1_memory_info_total', models.BigIntegerField()),
                ('gpu_bar1_memory_info_free', models.BigIntegerField()),
                ('gpu_bar1_memory_info_used', models.BigIntegerField()),
                ('gpu_utilization_gpu', models.IntegerField()),
                ('gpu_utilization_memory', models.IntegerField()),
                ('gpu_utilization_encoder', models.IntegerField()),
                ('gpu_utilization_decoder', models.IntegerField()),
                ('gpu_update_time', models.DateTimeField(auto_now=True)),
                ('used_port', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='gpu_stat', to='reverse_ssh_api.gpuspec')),
            ],
        ),
        migrations.CreateModel(
            name='UsedPort',
            fields=[
                ('used_port', models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, primary_key=True, related_name='used_port', serialize=False, to='reverse_ssh_api.reservedport')),
                ('user', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, to=settings.AUTH_USER_MODEL)),
            ],
        ),
        migrations.AddField(
            model_name='memoryspec',
            name='used_port',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='memory_spec', to='reverse_ssh_api.usedport'),
        ),
        migrations.AddField(
            model_name='gpuspec',
            name='used_port',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='gpus_spec', to='reverse_ssh_api.usedport'),
        ),
        migrations.CreateModel(
            name='CPUStat',
            fields=[
                ('id', models.BigAutoField(auto_created=True, primary_key=True, serialize=False, verbose_name='ID')),
                ('cpu_core', models.IntegerField()),
                ('cpu_percent', models.FloatField()),
                ('cpu_update_time', models.DateTimeField(auto_now=True)),
                ('used_port', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='cpu_stat', to='reverse_ssh_api.cpuspec')),
            ],
            options={
                'unique_together': {('used_port', 'cpu_core')},
            },
        ),
        migrations.AddField(
            model_name='cpuspec',
            name='used_port',
            field=models.OneToOneField(on_delete=django.db.models.deletion.CASCADE, related_name='cpu_spec', to='reverse_ssh_api.usedport'),
        ),
        migrations.AlterUniqueTogether(
            name='gpuspec',
            unique_together={('used_port', 'gpu_index')},
        ),
    ]
